from typing import List

import numpy as np
from matplotlib import pyplot as plt


history = {
    "lr_s": [
        1e-06,
        1e-05,
        0.0001,
        0.001,
        0.004,
        0.007,
        0.01,
        0.03,
        0.1
    ],
    "loss_history": [
        [
            0.5114144276622268,
            0.4076577210225546,
            0.2769996958147461,
            0.17784145690869646,
            0.10411980231651247,
            0.059720600256680925,
            0.03738974906626453,
            0.026644806998037677,
            0.02129739041900151,
            0.017923589523695452,
            0.01593362374437069,
            0.01445748271168547,
            0.01336439706457442,
            0.012454548985022613,
            0.011855872132832028,
            0.011222644755981684,
            0.010854219600345093,
            0.010368813589705242,
            0.010017758444513703,
            0.009822456990595741,
            0.00940358901348836,
            0.009235090164415063,
            0.009022533456262733,
            0.008725427554910714,
            0.008594261764888353,
            0.008435133639065766,
            0.00827364695995302,
            0.008133577883845701,
            0.007913329999020115,
            0.007795181764618597
        ],
        [
            0.1357088164857407,
            0.013239218421078423,
            0.009423494572956605,
            0.007680960627248326,
            0.006318408170154348,
            0.005346687755148849,
            0.004632953978837668,
            0.004050863407982305,
            0.0036673811567270007,
            0.003423410178596463,
            0.0030117125373408517,
            0.002832729655972821,
            0.0026767462084139725,
            0.0024937201725668693,
            0.0023087380277629025,
            0.0021589761329969107,
            0.002083329098928954,
            0.0018744849740022183,
            0.0018223471473357688,
            0.0016259131717966575,
            0.0016391034632589542,
            0.0015547319873486043,
            0.0014225342146246742,
            0.0013436030914484364,
            0.0012807749784466249,
            0.0012107370165150273,
            0.0011206778546994107,
            0.001083719688096924,
            0.001015740051552339,
            0.0009426968515949606
        ],
        [
            0.0222248410306767,
            0.0033575837105979606,
            0.002014458425390821,
            0.001421037525191491,
            0.0011267402884544949,
            0.0009540572097426485,
            0.0008856387638131944,
            0.0008369026512811753,
            0.00079459186585368,
            0.000762921669377139,
            0.0007196443208419151,
            0.0006421773905669589,
            0.0005592013605110466,
            0.0006231043267018344,
            0.0004954144784183481,
            0.0005718730815582749,
            0.0005416928198557604,
            0.0005308836485882322,
            0.0004819374365291268,
            0.0005454404736134591,
            0.0004561961522791098,
            0.0004480342279165914,
            0.0003742756791982205,
            0.0004672947408708848,
            0.00041776823119043133,
            0.00039627410599716933,
            0.00036653010266621706,
            0.00037290523337586386,
            0.0003754037583841111,
            0.00036594585243118424
        ],
        [
            0.01086623284289002,
            0.002736702941305132,
            0.002277858206190297,
            0.0016683944290766745,
            0.0019098069240445494,
            0.0015312190687988972,
            0.001369012105825139,
            0.0011559840404871723,
            0.0011767357362178757,
            0.001411746448520363,
            0.0014697359964829762,
            0.0011904741084460492,
            0.001038567848138114,
            0.0010627470643950804,
            0.001131902546431254,
            0.000829570819317625,
            0.0009594007764629419,
            0.000818038141183305,
            0.0006580436489755531,
            0.000795067627752553,
            0.0009085301599076928,
            0.0010229335156912121,
            0.0007963574195687229,
            0.0009783681040162271,
            0.0007141585399226794,
            0.0009139606109188457,
            0.0009534395972750062,
            0.0005915012045591749,
            0.0007081081952328586,
            0.0007303717963485077
        ],
        [
            0.013140725563900685,
            0.004446300547835601,
            0.002880330910618031,
            0.0029541229397191237,
            0.002972941375637266,
            0.002408798839070654,
            0.002546892688114364,
            0.0022978063130563507,
            0.0024001185825022068,
            0.002208253152381267,
            0.0021200273556077776,
            0.0017582326970090368,
            0.001949487565278894,
            0.001626897916189226,
            0.0019517239692332304,
            0.0018720024994844612,
            0.0019075526760588084,
            0.0018386594625638818,
            0.0020362974210938905,
            0.0015071876010283416,
            0.0020918803524589834,
            0.0013791686411989156,
            0.0014189729887706202,
            0.001638745453926784,
            0.0014468808035494123,
            0.0017863635533189326,
            0.001681963217232146,
            0.0015907738295027833,
            0.0011911103489962817,
            2.136369380528822
        ],
        [
            0.014696893609301135,
            0.009831080826996838,
            0.007489767895848452,
            0.005989269182493064,
            0.006048164303061317,
            0.004794689463263248,
            0.0077366626559554575,
            0.006845028571956541,
            0.020117684560484173,
            0.05574403043406814,
            0.0049056671435790625,
            0.00562251613216902,
            0.0053256970279384665,
            0.023678171668038383,
            0.05606446425147691,
            0.00421265875518238,
            0.0036464903192149054,
            0.005489366504369851,
            0.0039623216760638945,
            0.042546312511128614,
            0.00799140875369219,
            0.004008659029207226,
            0.009990805093378161,
            0.012840540616208672,
            0.012087143530871713,
            0.004254334386258268,
            0.0038781783632984507,
            0.011347906886759192,
            0.004110359806089347,
            0.004581752630184025
        ],
        [
            0.019132046276776383,
            0.010377890246514832,
            0.00861559606676165,
            0.008195483095057103,
            0.008875004532176226,
            0.008496848605127475,
            0.007862684214344254,
            0.006490697553676809,
            0.007850778650886727,
            0.03565265623630853,
            0.006265210170289064,
            0.008884548326224121,
            0.06813965898709176,
            0.00669367195189479,
            0.010157681010100403,
            0.006710096465568673,
            0.008056577808130898,
            0.0065927441909083275,
            0.007324275065362864,
            0.007922624975825809,
            0.05362487122126257,
            0.009484137913818377,
            0.009117896498948007,
            0.018753231958320273,
            0.007978565921674338,
            0.007066492354253028,
            0.00994359435905948,
            0.07229898193637474,
            0.008024473559155492,
            0.007450231454768969
        ],
        [
            3.8460111660704874,
            3.846240439203385,
            3.8462404390485436,
            3.8462404389675577,
            3.8462404392690908,
            3.8462404395859044,
            3.846240440409518,
            3.846240438632917,
            3.846240438254472,
            3.8462404387383518,
            3.8462404390317353,
            3.8462404407708997,
            3.8462404386818143,
            3.8462404395375165,
            3.8462404384897906,
            3.846240440156373,
            3.846240439553816,
            3.8462404391585627,
            3.8462404406051074,
            3.8462404394025396,
            3.8462404376412187,
            3.8462404383634725,
            3.846240439597365,
            3.846240440433967,
            3.846240440362149,
            3.8462404383762063,
            3.8462404393098386,
            3.846240438812207,
            3.8462404394076333,
            3.8462404391055904
        ],
        [
            3.845976178616805,
            3.84624043875516,
            3.846240438407531,
            3.8462404387953986,
            3.846240438384356,
            3.846240440355018,
            3.846240438481641,
            3.846240438738861,
            3.8462404411618234,
            3.8462404396286898,
            3.8462404394473624,
            3.8462404389940437,
            3.8462404381760327,
            3.846240440457906,
            3.8462404387765528,
            3.8462404398752135,
            3.8462404400061154,
            3.84624044082107,
            3.8462404380868973,
            3.8462404402378683,
            3.846240439248208,
            3.8462404387266367,
            3.846240439962312,
            3.8462404399414285,
            3.8462404404864294,
            3.846240440287275,
            3.846240439790662,
            3.846240440411046,
            3.8462404389940437,
            3.846240438594716
        ]
    ],
    "val_loss_history": [
        [
            0.4627000402327368,
            0.33240871165610253,
            0.21483841192988098,
            0.12796782791935932,
            0.07051917767715929,
            0.04072484784464628,
            0.02697861542035038,
            0.020430604078370256,
            0.016853406176441797,
            0.014633804037385147,
            0.01318441807100353,
            0.012112668107341046,
            0.01133862914519002,
            0.010725868932954448,
            0.010187205972217122,
            0.00976989696850613,
            0.009428266309558708,
            0.00908805608895374,
            0.008810113503458776,
            0.008655569230575963,
            0.008364468444575024,
            0.008149387746660403,
            0.00794427320711992,
            0.007802656898385045,
            0.007608505777750538,
            0.007462334779817624,
            0.007318261236081482,
            0.00718562229511064,
            0.007035806385234908,
            0.006900028816886868
        ],
        [
            0.0149613891154941,
            0.008716454427198301,
            0.007018781925804004,
            0.0057435695455085155,
            0.004932230694411669,
            0.004277753587827809,
            0.0036568062543973594,
            0.0034355235410146764,
            0.003045666840712293,
            0.0027690400627796525,
            0.0029364522164007246,
            0.0025420765427630267,
            0.002441938591745075,
            0.0020733228793310085,
            0.002090134462920342,
            0.0018395124471600219,
            0.0017840467252311471,
            0.0016187581649462729,
            0.0014765975973253028,
            0.0015193170094483625,
            0.0013389426024113273,
            0.0012835414696800332,
            0.0011095068972516587,
            0.0011515587991879246,
            0.0010377715082978088,
            0.0008708764421373098,
            0.0008203039715645576,
            0.0007398211124450252,
            0.0008106776368632091,
            0.0008830395680524948
        ],
        [
            0.003546154915541288,
            0.0020121104657788427,
            0.0010392884082920226,
            0.0009326697987966686,
            0.0013594719736579842,
            0.0002964195510623175,
            0.0003274933738427931,
            0.00027002606457088226,
            0.00034071331589688626,
            0.0005659318657586629,
            0.00031431148248207286,
            0.0001751170467109742,
            0.00017233551284217492,
            0.00019820131175016546,
            0.00022546472299288188,
            0.0002176690333065658,
            0.0002065651196828749,
            0.0002974243708269526,
            0.00020838904103898703,
            0.00020952671427416496,
            0.00020670870185021992,
            0.0001746792756890292,
            0.00011626864989594291,
            0.0003720535819956716,
            9.441192857158666e-05,
            0.0002348207075721526,
            0.0003424497559233636,
            0.00014148547527553679,
            0.00011215228834139326,
            0.00011895665027101956
        ],
        [
            0.0022530157798652294,
            0.0008178053531819041,
            0.001579310899604594,
            0.0003484401208749224,
            0.0011850633198579694,
            0.0005153473108800525,
            0.0013964921640005612,
            0.0005314043298062633,
            0.00028442484740998986,
            0.00226421393793438,
            0.000794349097345377,
            0.003215593720068414,
            0.0014882655814408483,
            0.0001568469817745492,
            0.00034973873481770814,
            0.0002160365339581626,
            0.00031867737078668414,
            0.000339109169812994,
            0.0006357087279713142,
            0.0005543965255987828,
            0.000322019393480017,
            0.0004591902045591205,
            0.0002892097486818576,
            0.00048260730005617947,
            0.0001562981468917458,
            0.00015966656363020765,
            0.00047965492688881785,
            0.0003818548298153326,
            0.0001237536316763709,
            0.00015567430621821882
        ],
        [
            0.0022579691356301047,
            0.0023468285871410697,
            0.0006726913975332633,
            0.0005004361124287092,
            0.0006211834991938888,
            0.0005116133577823215,
            0.001973806514032775,
            0.0004155187871158113,
            0.00048054354298131263,
            0.0009692906125937831,
            0.00048172600079400617,
            0.0001955125354960609,
            0.0017108364779747243,
            0.007915442064765897,
            0.0016133597738586826,
            0.0013298714722230068,
            0.0005231315148360068,
            0.00017839360832365165,
            0.0004016786756496941,
            0.000624668912993299,
            0.0006460372460176118,
            0.00182845734616278,
            0.0011362622564202588,
            0.00015778432433059982,
            0.000607227589697751,
            0.00011189117697012593,
            0.00015467250282736697,
            0.000158300344956701,
            0.00021529293426405735,
            3.8363824754563987
        ],
        [
            0.007410178735073987,
            0.0036176044979144076,
            0.0016813622529783375,
            0.0014869521112131946,
            0.000995160572928181,
            0.0031650232515403973,
            0.001957507355055558,
            0.003724983471997024,
            0.5336085092557273,
            0.0022845079566861854,
            0.0006742163971756239,
            0.0005563843008423922,
            0.00106311457927703,
            0.0005766842127956193,
            0.001119410028205101,
            0.0010421339429222184,
            0.005205515202868223,
            0.0015109126033786195,
            0.0008573306796139424,
            0.0009210749626855451,
            0.0015513526858125589,
            0.0002617437875699528,
            0.002825536910508671,
            0.0002805958375776912,
            0.0002873780411031144,
            0.0007392241829702363,
            0.003756950935111922,
            0.0006518063287353,
            0.000545316314285855,
            0.0021671476583631985
        ],
        [
            0.0024663100902633313,
            0.001256005276128226,
            0.0008755791275532546,
            0.001849985708207415,
            0.0027371897509844974,
            0.0035005987253594354,
            0.01094163354197293,
            0.0008856875440116441,
            0.004270987857114597,
            0.005616428605895776,
            0.003375186876352054,
            0.0007300986651372003,
            0.003008747192013358,
            0.0009270003150364053,
            0.002205897497635341,
            0.0010157904796708355,
            0.0008734269449260488,
            0.0028845130522368715,
            0.002237483080978203,
            0.0028319845361070837,
            0.0013538640205256467,
            0.0014033757821419713,
            0.0007791360463936407,
            0.0015662461705819172,
            0.005758091759941955,
            0.035394253082989595,
            0.013079711314322971,
            0.001276582621602386,
            0.00039598090750622044,
            0.0019179121786032972
        ],
        [
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987
        ],
        [
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987,
            3.8363824754563987
        ]
    ]
}


loss_history: List = history["loss_history"]
lr_s: List = history["lr_s"]


# allowed = lr_s
allowed = [1e-6, 1e-5, 1e-4, 1e-3, 4e-3, 7e-3, 1e-2]
for hist, learning_rate in zip(loss_history, lr_s):
    if learning_rate in allowed:
        plt.plot(np.arange(0, len(hist)), hist, label=f"lr: {learning_rate}")

plt.xlabel('Learning Rate [log]')
plt.ylabel('Loss')
plt.legend(loc="upper left", bbox_to_anchor=(0.0, 1.0))
plt.show()

plt.xscale("log")
plt.plot(lr_s, np.array(loss_history)[:, -1])
plt.xlabel('Epoch')
plt.ylabel('Loss')
plt.legend(loc="upper left", bbox_to_anchor=(0.0, 1.0))
plt.show()
