from typing import List

import numpy as np
from matplotlib import pyplot as plt


history = {
    "lr_s": [
        1e-06,
        1e-05,
        0.0001,
        0.001,
        0.004,
        0.007,
        0.01,
        0.03,
        0.1
    ],
    "loss_history": [
        [
            0.519657500906751,
            0.4028821715815429,
            0.283071539270333,
            0.1993137261643179,
            0.13178960267530127,
            0.08369168031559464,
            0.054012101771877735,
            0.03740123781864645,
            0.028461772638661516,
            0.023112846918766226,
            0.019697684510022136,
            0.01752051478925207,
            0.015835340775434796,
            0.0146313889036419,
            0.013585166699492024,
            0.012842722229441087,
            0.012189431613762902,
            0.011550308883882128,
            0.011015558544270526,
            0.01054880086884005
        ],
        [
            0.1559486342377217,
            0.012318850065049486,
            0.008918180769245372,
            0.007604331548116037,
            0.00661464783710935,
            0.005769412709917227,
            0.005133066747924095,
            0.004516394092650105,
            0.0039720176591380085,
            0.0035865473052136883,
            0.003333735600647584,
            0.0030709104636454402,
            0.002808779399029752,
            0.002631885622037326,
            0.0024028529297379364,
            0.002255332617483523,
            0.0021379491325932156,
            0.0019873927027293874,
            0.0018693748289042094,
            0.001753991289176448
        ],
        [
            0.021790337642851355,
            0.003189502511494223,
            0.0019380845563221952,
            0.0012517198251482727,
            0.0010381549176952509,
            0.0009183732558067352,
            0.0008872588750680188,
            0.0006823154792733174,
            0.000626761781104986,
            0.0007066500979361099,
            0.0006565118950952949,
            0.000577146067261434,
            0.0005820565643512336,
            0.0005831617227594227,
            0.0005634736994254408,
            0.00048570980289644846,
            0.0005154475351999125,
            0.00043122988734320265,
            0.00044906538644846303,
            0.00047404770881385175
        ],
        [
            0.00951988852534744,
            0.0026564800146703475,
            0.0018332244661472838,
            0.0014566176174990453,
            0.0012837244352133686,
            0.0012472155343702753,
            0.0010439698843250742,
            0.0010127511838458662,
            0.0007908744244036469,
            0.0008470667400155936,
            0.000799695855363555,
            0.0008143426186702998,
            0.0008620477320053694,
            0.0007119819187718778,
            0.0007300961797444981,
            0.0006493678986175382,
            0.0006944527321797548,
            0.0005368893019532968,
            0.0006291561547501495,
            0.0006349149157272822
        ],
        [
            0.010130613516385677,
            0.00406463360237965,
            0.0034985976816203,
            0.0032407606753626986,
            0.0028132929409561045,
            0.002951155911916995,
            0.0025994166496033587,
            0.002053237433136013,
            0.0038922611947211764,
            0.0017353469304154927,
            0.001955590989769927,
            0.0018850872037027425,
            0.001986307716255847,
            0.00211204243819555,
            0.0020575371288532453,
            0.0028511004063002388,
            0.0014192683569741523,
            0.0017563547268358575,
            0.0017048879591834113,
            0.0013211461495482174
        ],
        [
            0.02009939288928421,
            0.0062346489433963625,
            0.005020317473498115,
            0.00548406705264891,
            0.004436792831925253,
            0.004604761232305152,
            0.004527189233831837,
            0.0040853666852032015,
            0.004637129738174763,
            0.0036209762417497736,
            0.0037596625750255653,
            0.004041074440516183,
            0.003414804104439758,
            0.0039361785495379276,
            0.0035181093515132713,
            0.005851551127911949,
            0.0036184342654105176,
            0.0037277038985287147,
            0.005778206107236329,
            0.0038413463517344695
        ],
        [
            0.016519504561784644,
            0.009775548391469487,
            0.009161140848685719,
            0.009407579751890174,
            0.007840213104348254,
            0.007657572670108152,
            0.006838797724207944,
            0.007123553438095527,
            0.0072290728150114685,
            0.006780500801422789,
            0.007695288963820352,
            0.9832142395764564,
            0.25309650810359235,
            0.007345657550684783,
            0.007783998804389581,
            0.007817504908742692,
            0.006959945500889606,
            0.005926579731256495,
            0.047211600238423995,
            0.005938003538241142
        ],
        [
            3.8515597648391724,
            3.851749873462187,
            3.8517498751944754,
            3.8517498755612047,
            3.851749874960685,
            3.851749876376669,
            3.8517498748794443,
            3.851749875388536,
            3.8517498733200792,
            3.851749872549438,
            3.851749875634551,
            3.8517498759809063,
            3.851749874403969,
            3.8517498749907366,
            3.851749874334698,
            3.851749874603633,
            3.851749874695825,
            3.8517498749698533,
            3.851749875271387,
            3.851749875858154
        ],
        [
            3.851534146287704,
            3.851749873809052,
            3.8517498744808805,
            3.851749877178381,
            3.8517498748893764,
            3.8517498763068883,
            3.8517498745791845,
            3.851749873707183,
            3.851749873682734,
            3.8517498758174065,
            3.8517498749291055,
            3.8517498756956723,
            3.8517498762116404,
            3.8517498760455937,
            3.8517498754985553,
            3.851749875903486,
            3.851749876894165,
            3.851749876958852,
            3.8517498757486446,
            3.8517498751114516
        ]
    ]
}


loss_history: List = history["loss_history"]
lr_s: List = history["lr_s"]


# allowed = lr_s
allowed = [1e-6, 1e-5, 1e-4, 1e-3, 4e-3, 7e-3, 1e-2]
for hist, learning_rate in zip(loss_history, lr_s):
    if learning_rate in allowed:
        plt.plot(np.arange(0, len(hist)), hist, label=f"lr: {learning_rate}")

plt.xlabel('Learning Rate [log]')
plt.ylabel('Loss')
plt.legend(loc="upper left", bbox_to_anchor=(0.0, 1.0))
plt.show()

plt.xscale("log")
plt.plot(lr_s, np.array(loss_history)[:, -1])
plt.xlabel('Epoch')
plt.ylabel('Loss')
plt.legend(loc="upper left", bbox_to_anchor=(0.0, 1.0))
plt.show()
